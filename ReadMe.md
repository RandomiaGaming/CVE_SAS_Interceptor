# CVE SAS Interceptor
This program is created for educational and research purposes only. Installing software on systems you do not legally control without the consent of the owner is a crime! The computer fraud and abuse act is no joke and you could face fines or jail time.

# What Is SAS
SAS stands for secure attention sequence but most people just call it control alt delete. SAS is a security feature used to prevent impersonation attacks. Whenever you need to enter a password or other sensitive information windows can ask you to the SAS first. This gives the user confidence that they are looking at a genuine and trusted operating system popup and not just a look-alike. Pressing SAS should always bring up a trusted system screen. This means that if you saw a popup asking for your password you could press SAS and if it was a real windows popup nothing would change, however if it was a fake you would be taken to the logout/task manager screen and would instantly know the previous popup was a fake. Although not used frequently on personal computers many corporations use the SAS as part of enterprise security measures for critical systems.

# Scope Of This Paper
I'm sure someone else already discovered these exploits but I couldn't find anything about them online. Anyways this paper outlines two methods for interrupting the SAS and preventing it from working as intended. Both methods modify the operating system and make it so nothing happens when Ctrl + Alt + Del is pressed. Both methods also require administrator access to the PC.

# Method 1
The first method for blocking the SAS that I discovered was a simple registry hack. Originally I learned about the scancode map registry from the awesome keybinding utility SharpKeys. This registry is used to create keyboard remappings at the scancode level. We can use this registry maliciously to remap the control, alt, and delete keys to other keys on the keyboard. This makes it impossible for the user to input the SAS because no physical keys on their keyboard correspond to the virtual keys needed by the SAS. Importantly a simple key binding or keyboard layout will not work because the SAS is checked for before these remappings are applied. The scancode map registry seems unique in its ability to remap keys before the SAS is checked for. Huge shoutout to https://github.com/randyrants/sharpkeys for originally teaching me this method. For a quick and dirty implantation of this method see Method1.bat. Unfortunately this method does have some drawbacks. Firstly it requires administrators, secondly it requires you to disable either the control, alt, or delete keys which can make basic computer tasks difficult, and lastly the scancode map registry only updates when you restart the computer or sign out/back in again.

# Method 2
The brand new and improved method that I discovered makes use of the fact that winlogon.exe is responsible for handling the SAS. Unlike most windows keyboard shortcuts which are handled by the shell (explorer.exe) the SAS is special. It's the only sequence which still works even when the shell has crashed. At first I thought we could simply crash winlogon.exe to make the SAS stop working. Technically that works, however, windows becomes highly unstable and a fail safe mechanism kicks in which causes the user to be signed out within about 30 seconds. Thankfully there is a workaround. Once the user has finished logging and has reached their desktop winlogon.exe enters a dormant state where it doesn't do much. In this state we can attach a debugger to winlogon.exe and then place a breakpoint of sorts to stop the application from running. This is most certainly bad for your operating system and can lead to system crashes and instability. However, in my personal and very limited testing most windows features still seem to work even with winlogon.exe paused in this way. This method is great because it can be enabled/disabled at will and does not require a restart. However, it still has some drawbacks. Firstly it still requires administrator as winlogon.exe is a system process and cannot have a debugger attached to it by an unprivileged process, secondly this method only pauses winlogon.exe which means that when we chose to unpause it later on all the SAS inputs are handled all at once and tons of popups appear.